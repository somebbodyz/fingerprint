
<html lang="en">
<head>
<meta charset="utf-8" />
<title>FINGERPRINT</title>
</head>
<body>
<!
<table border="1" align="center"rules="rows" style="width:60%;">
<tr>
<td>
<table border="1" bgcolor="#7FFFD4" cellpadding="10" style="width:100%; border-radius:5px;">
<tr>
<th>
<h1>TASK</h1><h3>Description</h3>
</th></tr>
</table>
<table
border="1"
bgcolor="#e6e6fa"
cellpadding="10"
style="width:100%; border-radius:5px;">
<td rowspan="2" style="width:80%">
<p style="text-indent:20px">
<canvas class="canvas"></canvas>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</body>
<p><p2></p2>
<p><p3></p3>
<p><p4></p4>
<p><p5></p5>
<p><p6></p6>
<p><p7></p7>
<p><p8></p8>
<p><p9></p9>
<p><p10></p10>
<p><p11></p11>
<p><p12></p12>
<p><p13></p13>
<p><p14></p14>
<p><p15></p15>
<p><p16></p16>
<p><p17></p17>
<p><p18></p18>
<p><p19></p19>

</script>
<script type="text/javascript" >

var remember_vendor_and_renderer
var remember_canvas
var hash
var tor_check = false
var city_region
var glbOnError = 'N/A'
function get_renderer()

    {
       var canvas      = document.createElement('canvas');
       var gl          = canvas.getContext('webgl');
       var debugInfo   = gl.getExtension('WEBGL_debug_renderer_info');
       var vendor      = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
       var renderer    = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
       remember_vendor_and_renderer = vendor + " " + renderer 
    }
 function get_canvas_data()
 {    
      const canvas = document.querySelector('.canvas');
      const ctx = canvas.getContext('2d');
      ctx.globalCompositeOperation = 'lighter';
      ctx.fillStyle = "rgb(0, 0, 255)";
      ctx.fillRect(25,65,100,20);
      var txt = "This is fingerprint task!";
      ctx.font = "14px 'Arial'";
      ctx.fillStyle = "rgb(0, 0, 0)";
      ctx.fillText(txt, 25, 110);
      ctx.fillStyle = 'rgb(0,255,0)';
      ctx.beginPath();
      ctx.arc(50, 50, 50, 0, Math.PI*3, true);
      ctx.closePath();
      ctx.fill();
      ctx.fillStyle = 'rgb(255,0,0)';
      ctx.beginPath();
      ctx.arc(100, 50, 50, 0, Math.PI*2, true);
      ctx.closePath();
      ctx.fill();
      remember_canvas = canvas.toDataURL()    
 }

function detect_city_and_region()
  {
       jQuery.extend( {getValues: function(url) 
        {
              var result = null;
              $.ajax({url: "https://ipinfo.io/",type: 'get',dataType: 'json', async: false, success: function(data) {result = data;}});
              return result;
        }
        });   
        city_region = $.getValues("url string");
  }
  var fonts = ["Abadi MT Condensed Light", "Adobe Fangsong Std", "Adobe Hebrew", "Adobe Ming Std", "Agency FB", "Aharoni", "Andalus", "Angsana New", "AngsanaUPC", "Aparajita", "Arab", "Arabic Transparent", "Arabic Typesetting", "Arial Baltic", "Arial Black", "Arial CE", "Arial CYR", "Arial Greek", "Arial TUR", "Arial", "Batang", "BatangChe", "Bauhaus 93", "Bell MT", "Bitstream Vera Serif", "Bodoni MT", "Bookman Old Style", "Braggadocio", "Broadway", "Browallia New", "BrowalliaUPC", "Calibri Light", "Calibri", "Californian FB", "Cambria Math", "Cambria", "Candara", "Castellar", "Casual", "Centaur", "Century Gothic", "Chalkduster", "Colonna MT", "Comic Sans MS", "Consolas", "Constantia", "Copperplate Gothic Light", "Corbel", "Cordia New", "CordiaUPC", "Courier New Baltic", "Courier New CE", "Courier New CYR", "Courier New Greek", "Courier New TUR", "Courier New", "DFKai-SB", "DaunPenh", "David", "DejaVu LGC Sans Mono", "Desdemona", "DilleniaUPC", "DokChampa", "Dotum", "DotumChe", "Ebrima", "Engravers MT", "Eras Bold ITC", "Estrangelo Edessa", "EucrosiaUPC", "Euphemia", "Eurostile", "FangSong", "Forte", "FrankRuehl", "Franklin Gothic Heavy", "Franklin Gothic Medium", "FreesiaUPC", "French Script MT", "Gabriola", "Gautami", "Georgia", "Gigi", "Gisha", "Goudy Old Style", "Gulim", "GulimChe", "GungSeo", "Gungsuh", "GungsuhChe", "Haettenschweiler", "Harrington", "Hei S", "HeiT", "Heisei Kaku Gothic", "Hiragino Sans GB", "Impact", "Informal Roman", "IrisUPC", "Iskoola Pota", "JasmineUPC", "KacstOne", "KaiTi", "Kalinga", "Kartika", "Khmer UI", "Kino MT", "KodchiangUPC", "Kokila", "Kozuka Gothic Pr6N", "Lao UI", "Latha", "Leelawadee", "Levenim MT", "LilyUPC", "Lohit Gujarati", "Loma", "Lucida Bright", "Lucida Console", "Lucida Fax", "Lucida Sans Unicode", "MS Gothic", "MS Mincho", "MS PGothic", "MS PMincho", "MS Serif", "MS UI Gothic", "MV Boli", "Magneto", "Malgun Gothic", "Mangal", "Marlett", "Matura MT Script Capitals", "Meiryo UI", "Meiryo", "Menlo", "Microsoft Himalaya", "Microsoft JhengHei", "Microsoft New Tai Lue", "Microsoft PhagsPa", "Microsoft Sans Serif", "Microsoft Tai Le", "Microsoft Uighur","MS Sans Serif","Microsoft YaHei", "Microsoft Yi Baiti", "MingLiU", "MingLiU-ExtB", "MingLiU_HKSCS", "MingLiU_HKSCS-ExtB", "Miriam Fixed", "Miriam", "Mongolian Baiti", "MoolBoran", "NSimSun", "Narkisim", "News Gothic MT", "Niagara Solid", "Nyala", "PMingLiU", "PMingLiU-ExtB", "Palace Script MT", "Palatino Linotype", "Papyrus", "Perpetua", "Plantagenet Cherokee", "Playbill", "Prelude Bold", "Prelude Condensed Bold", "Prelude Condensed Medium", "Prelude Medium", "PreludeCompressedWGL Black", "PreludeCompressedWGL Bold", "PreludeCompressedWGL Light", "PreludeCompressedWGL Medium", "PreludeCondensedWGL Black", "PreludeCondensedWGL Bold", "PreludeCondensedWGL Light", "PreludeCondensedWGL Medium", "PreludeWGL Black", "PreludeWGL Bold", "PreludeWGL Light", "PreludeWGL Medium", "Raavi", "Rachana", "Rockwell", "Rod", "Sakkal Majalla", "Sawasdee", "Script MT Bold", "Segoe Print", "Segoe Script", "Segoe UI Light", "Segoe UI Semibold", "Segoe UI Symbol", "Segoe UI", "Shonar Bangla", "Showcard Gothic", "Shruti", "SimHei", "SimSun", "SimSun-ExtB", "Simplified Arabic Fixed", "Simplified Arabic", "Snap ITC", "Sylfaen", "Symbol", "Tahoma", "Times New Roman Baltic", "Times New Roman CE", "Times New Roman CYR", "Times New Roman Greek", "Times New Roman TUR", "Times New Roman", "TlwgMono", "Traditional Arabic", "Trebuchet MS", "Tunga", "Tw Cen MT Condensed Extra Bold", "Ubuntu", "Umpush", "Univers", "Utopia", "Utsaah", "Vani", "Verdana", "Vijaya", "Vladimir Script", "Vrinda", "Webdings", "Wide Latin", "Wingdings"];

(function () 
{
            const context = document.createElement("canvas").getContext("2d");
            context.font = "200px SANS-SERIF"
            const TEXT_TO_MEASURE = "A";
            var FONT_WIDTH = context.measureText(TEXT_TO_MEASURE).width;
            (function () 
            {
                var style = document.createElement("style");
                style.setAttribute("type", "text/css");
                style.textContent = `@font-face{font-family:'__DEFAULT_FONT__';src:url('data:application/font-woff;base64,d09GRgABAAAAAAM0AAsAAAAABCQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAABVPUy8yAAABcAAAADwAAABgNVxaOmNtYXAAAAG0AAAAKQAAADQADACUZ2FzcAAAAywAAAAIAAAACP//AANnbHlmAAAB6AAAACQAAAAwK9MKuGhlYWQAAAEIAAAAMwAAADYLo1XbaGhlYQAAATwAAAAcAAAAJP2RAdRobXR4AAABrAAAAAgAAAAIAMn9LGxvY2EAAAHgAAAABgAAAAYAGAAMbWF4cAAAAVgAAAAXAAAAIAAEAAVuYW1lAAACDAAAAQsAAAHwJKxCKHBvc3QAAAMYAAAAEwAAACD/KgCWeNpjYGRgYABi+QdqV+P5bb4ycHMwgMD1GraPEJqz/d80BoZ/PxgygFw2kFoGBgA++AvVAHjaY2BkYGBgBMOUf9MYc/79YACJIAMmAF7xBGN42mNgZGBgYGJgYQDRDFASCQAAAQEACgB42mNgZkhhnMDAysDAOovVmIGBURpCM19kSGMSYmBgAklhBR4+CgoMDgyOQMgIhhlgYUYoCaEZAIdLBiEAZP6WAGT+lnjaY2BgYGJgYGAGYhEgyQimWRgUgDQLEIL4jv//Q8j/B8B8BgBSlwadAAAAAAAADAAYAAB42mNg/DeNgeHfD4YMBmYGBkVTY9F/05IyMhgYcIgDAGnPDrV42oWQzU7CUBCFvwISZcEz3LjSBBoQ/yIrYzTEGEmIYY9QiglS01YMOx/DV+AtPXeophtjmumdOffMmXMH2GdOlaB2ACwUuzwQvi7yCk3d7PIqh794rcTZI+WryOslvMFn0OCJDW9EmjRhqtOxVRwJTXhXpxOa8CrOhJXQY0JhJ3Tocmn5NUt9jhEvxHKTk1kV6YyksNZ/ZnUsxaV0Uh4ZKm65YmycTL2J9J1UQ2l3/sT73JvKxlz0aJXc9Lkzds6NeiNNylWn1u37z0wjFP9UcSH8XFmbZ03JtYmFTu99Xqg4PqSR2Q5+9PxbnBx4Zyu9yP070+ultkPHoNhRmwchsaqpOLbhb0h9RfYAeNpjYGYAg//qDNMYsAAAKDQBwAAAAAAB//8AAg==');}`;
                document.documentElement.appendChild(style);
                var handleId = null;
                (function initailizeDefaultFont() {
                    context.font = "200px __DEFAULT_FONT__";
                    var width = context.measureText(TEXT_TO_MEASURE).width;
                    if (width != FONT_WIDTH) 
                    {
                        FONT_WIDTH = width;
                        cancelAnimationFrame(handleId);
                    }
                    else if (handleId == null) 
                    {
                        handleId = requestAnimationFrame(initailizeDefaultFont);
                    }

                })();
            })();
            function checkFontAvailable(font) 
            {
                if (/^\s*SANS-SERIF\s*$/i.test(font)) 
                {
                    return true;
                }
                if (!font || font == '__DEFAULT_FONT__') 
                {
                    return false;
                }

                context.font = `200px ${font.replace(/^\s*['"]|['"]\s*$/g, "")}, __DEFAULT_FONT__`;
                var width = context.measureText(TEXT_TO_MEASURE).width;
                return width != FONT_WIDTH;
            }
            this.checkFontAvailable = checkFontAvailable;
        }).apply(this);

function fingerprint_plugins() 
{
    var plugins =navigator.plugins.length; 
    var installed_plugins = ""
    for(var i=0 ;i <plugins; i++)
    {
      installed_plugins += (navigator.plugins[i].name + "separator") ; 
    }
    return (installed_plugins.split("separator",plugins))
}
var deviceMemoryKey = function (done, options) 
{
    return (navigator.deviceMemory || options.NOT_AVAILABLE)
  }
function fingerprint_touch() 
{
    var bolTouchEnabled, bolOut;
    bolTouchEnabled = false;
    bolOut = null;
    try 
    {
        if (document.createEvent("TouchEvent")) 
        {
            return true
        }
       return false
    } 
    catch (ignore) 
    {
      return false
    }
}
function fingerprint_fonst()
{
      var all_fonts = []
      var count = count = fonts.length;
      for (i = 0; i < count; i = i + 1)
         {
            if (checkFontAvailable(fonts[i]))
            {
              all_fonts.push(fonts[i])
            }
        }
        return all_fonts
}
function fingerprint() 
  {     
      jQuery.extend( {getValues: function(url) 
        {
              var result = null;
              $.ajax({url: "/fastcheck",type: 'post',dataType: 'text', async: false, success: function(data) {result = data;}});
              return result;
        }
        });   
      var results = $.getValues("url string");
      if(results!="Tor")
      {
         get_renderer()
         get_canvas_data()
      }
      else { remember_vendor_and_renderer ="TorVendor" ; remember_canvas= "TorCanvas" ; tor_check =true}
      var touch_support       = fingerprint_touch();
      var plugins             = fingerprint_plugins();
      var doNotTrack          = navigator.doNotTrack
      var cookieEnabled       = navigator.cookieEnabled;
       var all_fonts          = fingerprint_fonst();
      var user_agent          = navigator.userAgent;
      var user_lang           = navigator.language || navigator.userLanguage;
      var screen_expansion    = [screen.height, screen.width];
      var screen_color_depth  = screen.colorDepth;
      var kernell_count       = navigator.hardwareConcurrency;
      var cpuClass            = navigator.cpuClass;
      var devicePixelRatio    = window.devicePixelRatio;
      var platform            = navigator.platform;
      var p3                  = document.getElementsByTagName('p3') [0];
      var p4                  = document.getElementsByTagName('p4') [0];
      var p5                  = document.getElementsByTagName('p5') [0];
      var p6                  = document.getElementsByTagName('p6') [0];
      var p7                  = document.getElementsByTagName('p7') [0];
      var p8                  = document.getElementsByTagName('p8') [0];
      var p9                  = document.getElementsByTagName('p9') [0];
      var p10                 = document.getElementsByTagName('p10')[0];
      var p11                 = document.getElementsByTagName('p11')[0];
      var p12                 = document.getElementsByTagName('p12')[0];
      var p13                 = document.getElementsByTagName('p13')[0];
      var p14                 = document.getElementsByTagName('p14')[0];
      var p15                 = document.getElementsByTagName('p15')[0];
      var p16                 = document.getElementsByTagName('p16')[0];
      var p17                 = document.getElementsByTagName('p17')[0];
      p3.innerHTML            = 'Country : '                  + city_region.country;
      p4.innerHTML            = 'City : '                     + city_region.city;
      p5.innerHTML            = 'User Agent : '               + user_agent;
      p6.innerHTML            = 'Browser language : '         + user_lang;
      p7.innerHTML            = 'Resolution : '               + screen_expansion[0] + "x" + screen_expansion[1];
      p8.innerHTML            = 'Screen Color Depth: '        + screen_color_depth;
      p9.innerHTML            = 'Number of processor cores: ' + kernell_count;
      p11.innerHTML           = 'PixelRatio :  '              + devicePixelRatio;
      p12.innerHTML           = 'Platform :  '                + platform;
      p13.innerHTML           = 'Fonts :  '                   + all_fonts;
      p14.innerHTML           = 'Are cookie enabled? :  '     + (cookieEnabled ? "Yes" : "No" )
      p15.innerHTML           = 'Plugins : '                  + plugins
      p16.innerHTML           = 'Touch support : '            + (touch_support ? "Yes" : "No")
      p17.innerHTML           = 'Tracking : '                 + (doNotTrack    ? "Yes" : "No")
      p10.innerHTML           = 'Vendor and renderer :  '     + remember_vendor_and_renderer;
      hash = screen_expansion + screen_color_depth + kernell_count + remember_vendor_and_renderer + devicePixelRatio + plugins + all_fonts + doNotTrack + cookieEnabled + touch_support
      send_data_to_server()
 }
  function send_data_to_server() 
{
    $.post( "/postmethod",{"hash":hash,"canvas":remember_canvas},function(data)
    {   
        var p2 = document.getElementsByTagName('p2')[0];
        if(tor_check == true)
        {
          p2.innerHTML  = 'Ip: '                   + data.ip_info;
          return;
        }
        var server_answer = data ;
        var p19 = document.getElementsByTagName('p19')[0];
        p2.innerHTML  = 'Ip: '                   + server_answer.ip_info;
        p19.innerHTML = 'You are possible user_' + server_answer.user + " Your hash :" + server_answer.hash;
        var p18 = document.getElementsByTagName('p18')[0];
        p18.innerHTML = 'Canvas Hash : ' + server_answer.canvas_hash;
    })
}
 function AudioContextFingerprint()
 {
      let freq_data         = [];
      const ctx             = new AudioContext(); // AudioContext Object
      const oscillator      = ctx.createOscillator(); // OscillatorNode
      const analyser        = ctx.createAnalyser(); // AnalyserNode
      const gain            = ctx.createGain(); // GainNode
      const scriptProcessor = ctx.createScriptProcessor(4096, 1, 1); // ScriptProcessorNode
      gain.gain.value       = 0;
      oscillator.connect(analyser);
      analyser.connect(scriptProcessor);
      scriptProcessor.connect(gain);
      gain.connect(ctx.destination);
 } 
 // trash solution :(
detect_city_and_region()
fingerprint()
</script>
</td>
</tr>
<tr>
<td
bgcolor="#e6e6fa"
align="center">
<h3> INFORMATION</h3>
<p>  This web-server is writen on python3-7. Used framework - Flask.</p>
<!>
</td>
</tr>
</table>
<table border="1" bgcolor="#7FFFD4" height="100" cellpadding="10" style="width:100%; border-radius:5px;">
<tr>
<th>
<h3>Hope it works:)</h3>
</th>
</tr>
</table>
</td>
</tr>
</table>
</body>
</html>